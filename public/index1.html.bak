<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>welcome</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
</head>
<body>
  <h1>Welcome to 상원 홈</h1>
  <!-- post 양식 html.ver -->
  <form action="#" method="post" enctype="">
    <!-- enctype 이 content_type과 쌍으로 연결되어있다
     그리고 넘기는 데이터의 종류에 따라 타입을 설정해줘야한다. -->
     <fieldset>
       <ul>
         <li>
           <label for="u_id">아이디</label>
           <input type="text" id = "u_id" name="u_id">
         </li>
         <li>
           <label for="u_pw">패스워드</label>
           <input type="password" id ="u_pw" name="u_pw">
         </li>
       </ul>
       <button type="submit">전송</button>
     </fieldset>
  </form>
  <script>
    // 객체타입.
    const data = {
      board_no: 13,
      title: 'test',
      content: 'content',
      writer: 'user00'
    };
    // 서버전달 할 때는 객체타입으로 전달이 안되고 문자열로 전달해야됨
    // 문자로 변환해주는 것이 JSON.stringify()
    const json = JSON.stringify(data);
    // 문자열을 다시 객체로 되돌리는 JSON.parse
    const obj = JSON.parse(json);

    //post 요청
    // fetch 메소드 매개값
    // 1. 경로가 중요함, 현재 html이 있는 경로를 기준으로 불러올 파일의 경로를 설정해야함
    // 2. 옵션 객체
    // 2-1. 방식(post, get 방식, 대신 방식 통일 되어야함), 헤더부분, 바디부분
    fetch("add_board", {
      method: 'post',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(data),
    })
      .then((data /* fetch에서의 결과값 */) => {
        console.log(data);
        return data.text(); // 결과값이 strean이라 문자열로 변환
      }) // fetch의 실행이 성공이면
      .then(result /* 위의 then의 결과값 */=> {
        console.log(result);
        if(result == '처리완료') {
          alert('성공');
        } else if (result == '처리 중 에러') {
          alert('실패');
        }
      })
      .catch((err) => {
        console.log(err);
      }) // fetch의 실행이 에러면;
  </script>
</body>
</html>